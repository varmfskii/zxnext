<!DOCTYPE HTML>

<!--Converted with LaTeX2HTML 2019 (Released January 1, 2019) -->
<HTML lang="EN">
<HEAD>
<TITLE>Programming Sprites</TITLE>
<META NAME="description" CONTENT="Programming Sprites">
<META NAME="keywords" CONTENT="000-document">
<META NAME="resource-type" CONTENT="document">
<META NAME="distribution" CONTENT="global">

<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=utf-8">
<META NAME="viewport" CONTENT="width=device-width, initial-scale=1.0">
<META NAME="Generator" CONTENT="LaTeX2HTML v2019">

<LINK REL="STYLESHEET" HREF="000-document.css">

<LINK REL="next" HREF="node43.html">
<LINK REL="previous" HREF="node41.html">
<LINK REL="next" HREF="node43.html">
</HEAD>

<BODY >

<DIV CLASS="navigation"><!--Navigation Panel-->
<A
 HREF="node43.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node41.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html462"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html464"
  HREF="node135.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node43.html">Global Control of Sprites</A>
<B> Up:</B> <A
 HREF="node34.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node41.html">Relative Sprites</A>
 &nbsp; <B>  <A ID="tex2html463"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html465"
  HREF="node135.html">Index</A></B> 
<BR>
<BR></DIV>
<!--End of Navigation Panel-->

<H2><A ID="SECTION00365000000000000000">
Programming Sprites</A>
</H2>

<P>
Sprites are created via three io registers and a nextreg interface.

<P>
Port $303B (W)
<PRE>
X S S S S S S S
N6 X N N N N N N
</PRE>
A write to this port has two effects.

<P>
One is it selects one of 128 sprites for writing sprite attributes via
port $57.

<P>
The other is it selects one of 128 4-bit patterns in pattern memory
for writing sprite patterns via port $5B. The N6 bit shown is the
least significant in the 7-bit pattern number and should always be
zero when selecting one of 64 8-bit patterns indicated by N.

<P>
Port $57 (W)

<P>
Once a sprite is selected via port $303B, its attributes can be
written to this port one byte after another. Sprites can have either
four or five attribute bytes and the internal attribute pointer will
move onto the next sprite after those four or five attribute bytes are
written. This means you can select a sprite via port $303B and write
attributes for as many sequential sprites as desired. The attribute
pointer will roll over from sprite 127 to sprite 0.

<P>
Port $5B (W)

<P>
Once a pattern number is selected via port $303B, the 256-byte or
128-byte pattern can be written to this port. The internal pattern
pointer auto-increments after each write so as many sequential
patterns as desired can be written. The internal pattern pointer will
roll over from pattern 127 to pattern 0 (4-bit patterns) or from
pattern 63 to pattern 0 (8-bit patterns) automatically.

<P>
Port $303B (R)

<P>
<PRE>
0 0 0 0 0 0 M C
</PRE>
M = 1 if the maximum number of sprites per line was exceeded
<BR>
C = 1 if any two displayed sprites collide on screen
<BR>
Reading this port automatically resets the M and C bits.

<P>
Besides the i/o interface, there is a nextreg interface to sprite
attributes. The nextreg interface allows the copper to manipulate
sprites and grants the program random access to a spriteâ€™s individual
attribute bytes.

<P>
(R/W) $34 (52) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Number
<BR>
If the sprite number is in lockstep with io port $303B (nextreg $09
bit 4 is set)
<table width="90%"><tr><td valign="top">&nbsp;bits 7 = Pattern address offset (Add 128 to pattern address)</td></tr>
<tr><td valign="top">&nbsp;bits 6-0 = Sprite number 0-127, Pattern number 0-63
</td></tr></table>

Selects which sprite has its attributes connected to the following registers.

<P>
Effectively performs an out to port $303B with the same value

<P>
Otherwise
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Ignored</td></tr>
<tr><td valign="top">&nbsp;bits 6-0 = Sprite number 0-127
</td></tr></table>

Selects which sprite has its attributes connected to the following registers.
<BR>
Bit 7 always reads back as zero.

<P>
This nextreg can operate in two modes.

<P>
If nextreg $09 bit 4 is set, then this register is kept in lockstep
with i/o port $303B. A write to this nextreg is equivalent to a write
to port $303B and vice versa. In this mode, the i/o interface and
nextreg interface are exactly equivalent.

<P>
If nextreg $09 bit 4 is reset, then the nextreg interface is
decoupled from i/o port $303B. This nextreg is used to select a
particular sprite 0-127 and this is completely independent from the
sprite selected for the i/o interface. This independence allows the
copper, for example, to manipulate different sprites than the cpu
using the i/o interface.

<P>
(W) $35 (53) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0
<BR>(W) $75 (117) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 0 with automatic post
increment of Sprite Number
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of X coordinate
</td></tr></table>

A write to nextreg $75 also increases the selected sprite in nextreg
$34.

<P>
(W) $36 (54) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1
<BR>(W) $76 (118) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 1 with automatic post
increment of Sprite Number
<table width="90%"><tr><td valign="top">&nbsp;bits 7-0 = LSB of Y coordinate
</td></tr></table>

A write to nextreg $76 also increases the selected sprite in nextreg
$34.

<P>
(W) $37 (55) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2
<BR>(W) $77 (119) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 2 with automatic post
increment of Sprite Number
<table width="90%"><tr><td valign="top">&nbsp;bits 7-4 = Palette offset added to top 4 bits of sprite colour
  index</td></tr>
<tr><td valign="top">&nbsp;bit 3 = X mirror</td></tr>
<tr><td valign="top">&nbsp;bit 2 = Y mirror</td></tr>
<tr><td valign="top">&nbsp;bit 1 = Rotate</td></tr>
<tr><td valign="top">&nbsp;bit 0 = MSB of X coordinate
</td></tr></table>

A write to nextreg $77 also increases the selected sprite in nextreg
$34.

<P>
(W) $38 (56) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3
<BR>(W) $78 (120) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 3 with automatic post
increment of Sprite Number
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = Visible flag (1 = displayed)</td></tr>
<tr><td valign="top">&nbsp;bit 6 = Extended attribute (1 = Sprite Attribute 4 is active)</td></tr>
<tr><td valign="top">&nbsp;bits 5-0 = Pattern used by sprite (0-63)
</td></tr></table>

A write to nextreg $78 also increases the selected sprite in nextreg
$34.

<P>
(W) $39 (57) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4
<BR>(W) $79 (121) <SPAN CLASS="MATH"><IMG STYLE="height: 1.06ex; vertical-align: -0.11ex; " SRC="img2.svg"
 ALT="$\Rightarrow$"></SPAN> Sprite Attribute 4 with automatic post
increment of Sprite Number
<BR>
4-bit Sprites
<table width="90%"><tr><td valign="top">&nbsp;bit 7 = H (1 = sprite uses 4-bit patterns)</td></tr>
<tr><td valign="top">&nbsp;bit 6 = N6 (0 = use the first 128 bytes of the pattern else
  use the last 128 bytes)</td></tr>
<tr><td valign="top">&nbsp;bit 5 = 1 if relative sprites are composite, 0 if relative
  sprites are unified Scaling</td></tr>
<tr><td valign="top">&nbsp;bits 4-3 = X scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)</td></tr>
<tr><td valign="top">&nbsp;bits 2-1 = Y scaling (00 = 1x, 01 = 2x, 10 = 4x, 11 = 8x)</td></tr>
<tr><td valign="top">&nbsp;bit 0 = MSB of Y coordinate
</td></tr></table>

A relative mode is enabled if H,N6 = 01. The byte format for relative
sprites is described above.
<BR>
A write to nextreg $79 also increases the selected sprite in nextreg
$34.

<P>

<DIV CLASS="navigation"><HR>
<!--Navigation Panel-->
<A
 HREF="node43.html">
<IMG WIDTH="37" HEIGHT="24" ALT="next" SRC="next.png"></A> 
<A
 HREF="node34.html">
<IMG WIDTH="26" HEIGHT="24" ALT="up" SRC="up.png"></A> 
<A
 HREF="node41.html">
<IMG WIDTH="63" HEIGHT="24" ALT="previous" SRC="prev.png"></A> 
<A ID="tex2html462"
  HREF="node1.html">
<IMG WIDTH="65" HEIGHT="24" ALT="contents" SRC="contents.png"></A> 
<A ID="tex2html464"
  HREF="node135.html">
<IMG WIDTH="43" HEIGHT="24" ALT="index" SRC="index.png"></A> 
<BR>
<B> Next:</B> <A
 HREF="node43.html">Global Control of Sprites</A>
<B> Up:</B> <A
 HREF="node34.html">Sprites</A>
<B> Previous:</B> <A
 HREF="node41.html">Relative Sprites</A>
 &nbsp; <B>  <A ID="tex2html463"
  HREF="node1.html">Contents</A></B> 
 &nbsp; <B>  <A ID="tex2html465"
  HREF="node135.html">Index</A></B> </DIV>
<!--End of Navigation Panel-->

</BODY>
</HTML>
